(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,a,s){e.exports=s(34)},27:function(e,a,s){},33:function(e,a,s){},34:function(e,a,s){"use strict";s.r(a);var t=s(0),n=s.n(t),r=s(12),c=s.n(r),i=(s(27),s(4)),o=s(5),l=s(8),u=s(6),h=s(9),S=s(7),g=s(20),m=function(e){function a(){var e,s;Object(i.a)(this,a);for(var t=arguments.length,r=new Array(t),c=0;c<t;c++)r[c]=arguments[c];return(s=Object(l.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(r)))).handleChangeText=function(e){(0,s.props.searchImages)(e.target.value,{shouldShowTypingMessage:!0})},s.handleSaveSearch=function(){var e=s.props,a=e.saveSearch;""!==e.searchText&&a()},s.renderSaveSearchContent=function(){var e=s.props,a=e.isSearchSaveLoading,t=e.shouldShowSuccessMessage,r=e.searchText;return a?n.a.createElement("div",{className:"title save-loading-message"},"saving..."):t?n.a.createElement("div",{className:"title save-success-message"},"search saved Successfully!"):n.a.createElement("div",{className:"title save-search-button ".concat(""===r?"disabled":""),onClick:s.handleSaveSearch},"Save this search")},s.handleShowHistory=function(){(0,s.props.togglePreviousSearches)()},s}return Object(h.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){var e=this.props,a=e.searchText,s=e.isPreviousSearchesVisible,t="".concat(s?"Hide":"Show"," previous");return n.a.createElement("div",null,n.a.createElement("div",{className:"search-container"},n.a.createElement("div",{className:"title"},"Image Gallery"),n.a.createElement("div",{className:"title sub-title"},"Search for images"),n.a.createElement("input",{type:"text",className:"search-input",value:a,onChange:this.handleChangeText}),n.a.createElement("div",{className:"search-controls"},this.renderSaveSearchContent(),n.a.createElement("div",{className:"title show-history-search-button",onClick:this.handleShowHistory},t))))}}]),a}(t.Component),v=s(11),p=function(e){return Array.isArray(e)&&(e=e.length>1?e.join(","):e[0]),e},d=function(e,a){var s=a.searchMode,t=void 0===s?"any":s,n=a.page,r=void 0===n?1:n,c="https://api.flickr.com/services/rest/?method=flickr.photos.search&safe_search=1&format=json&nojsoncallback=1&api_key=bac9f1ccfd854f27894fd47c4f01b1e8&content_type=1&is_getty=1&tags=".concat(e,"&tag_mode=").concat(t,"&page=").concat(r);return fetch(c).then(function(e){return e.json()}).then(function(e){return{images:e.photos.photo,page:e.photos.page,pages:e.photos.pages}}).catch(function(e){return console.error(e)})},E={setItem:function(e,a){return new Promise(function(s,t){setTimeout(function(){s(localStorage.setItem(e,a))},500)})},getItem:function(e){return new Promise(function(a,s){setTimeout(function(){a(localStorage.getItem(e))},500)})}},f=function(e){function a(){var e,s;Object(i.a)(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(s=Object(l.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(n)))).state={selectedPreviousItems:[]},s.onPreviousSearchSelect=function(e,a){var t=s.state.selectedPreviousItems;if(a)s.setState({selectedPreviousItems:[].concat(Object(v.a)(t),[e])});else{var n=t.indexOf(e),r=Object(v.a)(t);r.splice(n,1),s.setState({selectedPreviousItems:r})}},s.createOnSearchClickCallback=function(e){return function(){return s.onSearchClick(e)}},s.onSearchClick=function(e){(0,s.props.searchImages)(s.state.selectedPreviousItems,{searchMode:e})},s}return Object(h.a)(a,e),Object(o.a)(a,[{key:"componentDidMount",value:function(){(0,this.props.loadPreviousSearches)()}},{key:"render",value:function(){var e=this.props,a=e.previousSearches,s=e.isVisible,t=this.state.selectedPreviousItems;return n.a.createElement("div",{className:"previous-search-side-bar ".concat(s?"visible":"")},n.a.createElement("div",{className:"search-options-container"},n.a.createElement(y,{selectedPreviousItems:t,onSingleSearchClick:this.createOnSearchClickCallback(),onUnionSearchClick:this.createOnSearchClickCallback("any"),onIntersectionSearchClick:this.createOnSearchClickCallback("all")})),n.a.createElement("div",{className:"previous-searches-list"},a&&n.a.createElement(C,{selectedPreviousItems:t,onPreviousSearchSelect:this.onPreviousSearchSelect,previousSearches:a})))}}]),a}(t.Component),I={loadPreviousSearches:function(){return function(e){E.getItem("previousSearches").then(function(a){var s=JSON.parse(a)||{};e({type:"IMAGES@LOAD_PREVIOUS_SEARCHES_SUCCESS",payload:{previousSearches:s}})})}}},b=Object(S.b)(function(e){return{previousSearches:e.imagesData.previousSearches}},I)(f),C=function(e){var a=e.previousSearches,s=e.onPreviousSearchSelect,t=e.selectedPreviousItems;return 0===a.length?n.a.createElement("div",{className:"no-prev-searches"},"No previous searches yet"):Object.keys(a).map(function(e,a){return n.a.createElement(O,{key:"searches-list-item-".concat(a),isSelected:t.includes(e),searchValue:e,onPreviousSearchSelect:s})})},O=function(e){var a=e.searchValue,s=e.onPreviousSearchSelect,t=e.isSelected;return n.a.createElement("div",{className:"previous-search-item ".concat(t?"selected":""),onClick:function(){return s(a,!t)}},n.a.createElement("div",{className:"previous-search-label"},a))},y=function(e){var a=e.selectedPreviousItems,s=e.onSingleSearchClick,t=e.onUnionSearchClick,r=e.onIntersectionSearchClick,c=Object.keys(a).length;return 1===c?n.a.createElement("div",{className:"previous-search-controls",onClick:s},n.a.createElement("div",{className:"search-button"},"Search")):c>1?n.a.createElement("div",{className:"previous-search-controls"},n.a.createElement("div",{className:"search-button",onClick:t},'Search - "OR"'),n.a.createElement("div",{className:"search-button",onClick:r},'Search - "AND"')):null},M=(s(33),function(e){function a(){var e,s;Object(i.a)(this,a);for(var t=arguments.length,r=new Array(t),c=0;c<t;c++)r[c]=arguments[c];return(s=Object(l.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(r)))).state={searchText:"",isInfiniteScrollingEnded:!1},s.loadMoreImages=function(){var e=s.props,a=e.currentPage,t=e.totalPages,n=e.loadMoreImages,r=s.state.searchText;a<t?n(r,a+1):s.setState({isInfiniteScrollingEnded:!0})},s.searchImages=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=a.searchMode,n=a.shouldShowTypingMessage,r=void 0!==n&&n,c=a.page,i=s.props.showTypingMessage,o=p(e),l=t?" - (".concat("any"===t?"OR":"AND",")"):"";s.setState({searchText:"".concat(o).concat(l),isInfiniteScrollingEnded:!1}),r&&i(),s.debouncedSearchImages(o,t,c)},s.debouncedSearchImages=Object(g.debounce)(function(e,a,t){(0,s.props.searchImages)(e,a,t)},500),s.saveSearch=function(){var e=s.state.searchText;(0,s.props.saveSearch)(e)},s.renderImagesContainerContent=function(){var e=s.props,a=e.images,t=e.isLoadingNewImages,r=e.isTypingMessageVisible,c=s.state.searchText;return t?n.a.createElement("div",{className:"message loading-message"},"loading..."):n.a.createElement(P,{images:a,searchText:c,isTypingMessageVisible:r})},s.setImageContainerRef=function(e){s.imagesContainerRef=e},s}return Object(h.a)(a,e),Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.imagesContainerRef.onscroll=function(a){var s=e.imagesContainerRef.scrollTop+e.imagesContainerRef.offsetHeight===e.imagesContainerRef.scrollHeight;e.imagesContainerRef.scrollHeight>e.imagesContainerRef.offsetHeight&&s&&e.loadMoreImages()}}},{key:"render",value:function(){var e=this.props,a=e.isSearchSaveLoading,s=e.shouldShowSuccessMessage,t=e.togglePreviousSearches,r=e.isPreviousSearchesVisible,c=this.state.isInfiniteScrollingEnded;return n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"image-gallery"},n.a.createElement(m,{searchImages:this.searchImages,saveSearch:this.saveSearch,isSearchSaveLoading:a,shouldShowSuccessMessage:s,searchText:this.state.searchText,togglePreviousSearches:t,isPreviousSearchesVisible:r}),n.a.createElement("div",{className:"images-container",ref:this.setImageContainerRef},this.renderImagesContainerContent(),c&&n.a.createElement("div",{className:"no-more-results message"},"No more images to show"))),n.a.createElement(b,{searchImages:this.searchImages,isVisible:r}))}}]),a}(t.Component)),A={searchImages:function(e,a,s){return function(t){if(!e)return t({type:"IMAGES@CLEAR_IMAGES"});t({type:"IMAGES@IMAGES_LOADING"}),d(e,{searchMode:a,page:s}).then(function(e){var a=e.images,s=e.page,n=e.pages;t({type:"IMAGES@IMAGES_LOADED_SUCCESS",payload:{images:a,page:s,pages:n}})})}},loadMoreImages:function(e,a){return function(s){d(e,{page:a}).then(function(e){var a=e.images,t=e.page,n=e.pages;s({type:"IMAGES@IMAGES_LOADED_MORE_SUCCESS",payload:{images:a,page:t,pages:n}})})}},saveSearch:function(e){return function(a){a({type:"IMAGES@SEARCH_SAVE_LOADING"}),E.getItem("previousSearches").then(function(a){var s=JSON.parse(a)||{};return s[e]="",E.setItem("previousSearches",JSON.stringify(s))}).then(function(){a({type:"IMAGES@SEARCH_SAVE_SUCCESS",payload:{searchText:e}}),setTimeout(function(){a({type:"IMAGES@HIDE_SAVE_SUCCESS_MESSAGE"})},2e3)})}},showTypingMessage:function(){return{type:"IMAGES@SHOW_TYPING_MESSAGE"}},togglePreviousSearches:function(){return{type:"IMAGES@TOGGLE_PREVIOUS_SEARCHES"}}},N=Object(S.b)(function(e){return{images:e.imagesData.images,currentPage:e.imagesData.currentPage,totalPages:e.imagesData.totalPages,isLoadingNewImages:e.imagesData.isLoadingNewImages,isSearchSaveLoading:e.imagesData.isSearchSaveLoading,isPreviousSearchesVisible:e.imagesData.isPreviousSearchesVisible,shouldShowSuccessMessage:e.imagesData.shouldShowSuccessMessage,isTypingMessageVisible:e.imagesData.isTypingMessageVisible}},A)(M),P=function(e){var a=e.images,s=e.searchText;return e.isTypingMessageVisible?n.a.createElement("div",{className:"message"},"Typing... :)"):a?0===a.length?n.a.createElement("div",{className:"message"},'No results for "'.concat(s,'".')):Object.keys(a).map(function(e){var s=a[e],t=function(e){var a=e.farm,s=e.server,t=e.id,n=e.secret;return"https://farm".concat(a,".staticflickr.com/").concat(s,"/").concat(t,"_").concat(n,".jpg")}(s);return n.a.createElement("img",{key:s.id,alt:"",className:"image-item",src:t})}):n.a.createElement("div",{className:"message"},"Please search images!")};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var _=s(10),j=s(21),w=s(13),G=s(1),k={images:null,currentPage:null,totalPages:null,isLoadingNewImages:!1,isSearchSaveLoading:!1,shouldShowSuccessMessage:!1,isTypingMessageVisible:!1,isPreviousSearchesVisible:!1,previousSearches:[]},T=Object(_.c)({imagesData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,a=arguments.length>1?arguments[1]:void 0,s=a.type,t=a.payload;switch(s){case"IMAGES@IMAGES_LOADING":return Object(G.a)({},e,{isLoadingNewImages:!0});case"IMAGES@IMAGES_LOADED_SUCCESS":return Object(G.a)({},e,{isLoadingNewImages:!1,isTypingMessageVisible:!1,images:t.images,currentPage:t.page,totalPages:t.pages});case"IMAGES@IMAGES_LOADED_MORE_SUCCESS":return Object(G.a)({},e,{isLoadingNewImages:!1,isTypingMessageVisible:!1,currentPage:t.page,totalPages:t.pages,images:[].concat(Object(v.a)(e.images),Object(v.a)(t.images))});case"IMAGES@CLEAR_IMAGES":return Object(G.a)({},e,{isLoadingNewImages:!1,isTypingMessageVisible:!1,images:null});case"IMAGES@SEARCH_SAVE_LOADING":return Object(G.a)({},e,{isSearchSaveLoading:!0,isTypingMessageVisible:!1});case"IMAGES@SHOW_TYPING_MESSAGE":return Object(G.a)({},e,{isTypingMessageVisible:!0});case"IMAGES@SEARCH_SAVE_SUCCESS":return Object(G.a)({},e,{isSearchSaveLoading:!1,shouldShowSuccessMessage:!0,previousSearches:Object(G.a)({},e.previousSearches,Object(w.a)({},t.searchText,""))});case"IMAGES@HIDE_SAVE_SUCCESS_MESSAGE":return Object(G.a)({},e,{shouldShowSuccessMessage:!1});case"IMAGES@LOAD_PREVIOUS_SEARCHES_SUCCESS":return Object(G.a)({},e,{previousSearches:t.previousSearches});case"IMAGES@TOGGLE_PREVIOUS_SEARCHES":return Object(G.a)({},e,{isPreviousSearchesVisible:!e.isPreviousSearchesVisible});default:return e}}}),V=Object(_.d)(T,Object(_.a)(j.a));c.a.render(n.a.createElement(S.a,{store:V},n.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[22,1,2]]]);
//# sourceMappingURL=main.1ff47492.chunk.js.map